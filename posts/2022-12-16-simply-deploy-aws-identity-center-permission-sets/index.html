<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Simply Deploy AWS IAM Identity Center Permission Sets with Ezpresso · Morten Jensen
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Morten Jensen">
<meta name="description" content="With AWS IAM Identity Center, formerly known as AWS Single Sign-On, it became simpler to integrate identity providers such as Azure AD, JumpCloud etc across the whole AWS organization.
Cloudformation support in turn enabled simpler and more consistent, declarative provisioning of Permission Sets in the Organization.
One of the remaining challenges with Permission Sets is to automatically provision them into new accounts or as the Organizational layout changes.
Cue Ezpresso.">
<meta name="keywords" content="AWS, IAM, Identity Center, Organizations, Permission Sets">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Simply Deploy AWS IAM Identity Center Permission Sets with Ezpresso">
  <meta name="twitter:description" content="With AWS IAM Identity Center, formerly known as AWS Single Sign-On, it became simpler to integrate identity providers such as Azure AD, JumpCloud etc across the whole AWS organization.
Cloudformation support in turn enabled simpler and more consistent, declarative provisioning of Permission Sets in the Organization.
One of the remaining challenges with Permission Sets is to automatically provision them into new accounts or as the Organizational layout changes.
Cue Ezpresso.">

<meta property="og:url" content="https://jensenmo.github.io/posts/2022-12-16-simply-deploy-aws-identity-center-permission-sets/">
  <meta property="og:site_name" content="Morten Jensen">
  <meta property="og:title" content="Simply Deploy AWS IAM Identity Center Permission Sets with Ezpresso">
  <meta property="og:description" content="With AWS IAM Identity Center, formerly known as AWS Single Sign-On, it became simpler to integrate identity providers such as Azure AD, JumpCloud etc across the whole AWS organization.
Cloudformation support in turn enabled simpler and more consistent, declarative provisioning of Permission Sets in the Organization.
One of the remaining challenges with Permission Sets is to automatically provision them into new accounts or as the Organizational layout changes.
Cue Ezpresso.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-12-17T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-12-17T00:00:00+00:00">




<link rel="canonical" href="https://jensenmo.github.io/posts/2022-12-16-simply-deploy-aws-identity-center-permission-sets/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.4b392a85107b91dbdabc528edf014a6ab1a30cd44cafcd5325c8efe796794fca.css" integrity="sha256-SzkqhRB7kdvavFKO3wFKarGjDNRMr81TJcjv55Z5T8o=" crossorigin="anonymous" media="screen" />








 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>




<body class="preload-transitions colorscheme-light">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://jensenmo.github.io/">
      Morten Jensen
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://jensenmo.github.io/posts/2022-12-16-simply-deploy-aws-identity-center-permission-sets/">
          Simply Deploy AWS IAM Identity Center Permission Sets with Ezpresso
        </a>
      </h1>
    </header>

    <p>With AWS IAM Identity Center, formerly known as AWS Single Sign-On, it became simpler to integrate identity providers such as Azure AD, JumpCloud etc across the whole AWS organization.</p>
<p>Cloudformation support in turn enabled simpler and more consistent, declarative provisioning of Permission Sets in the Organization.</p>
<p>One of the remaining challenges with Permission Sets is to automatically provision them into new accounts or as the Organizational layout changes.</p>
<p>Cue Ezpresso.</p>
<p>Ezpresso is a <a href="https://docs.aws.amazon.com/cdk/v2/guide/home.html"  class="external-link" target="_blank" rel="noopener">CDK app</a> built to automatically provision permission sets into an ever-changing AWS Organization and Organizational Unit structure.</p>
<p>Ezpresso enables Identity Center administrators to define SSO permission sets that are mapped to the OU structure of the Organization rather than to individual accounts (although this is also possible).</p>
<p>Definition and mappings are declarative and in YAML file format, which makes it easy to create new permission sets and map them to OUs or directly to accounts as well as to identity provider groups.</p>
<p>When new accounts are added from Control Tower, the CDK app runs automatically to re-evaluate permission set mappings and deploys new mappings as required to the new accounts. In addition, when existing accounts are moved, permission sets are unmapped or re-mapped as required.</p>
<p>This is made possible by the <a href="https://docs.aws.amazon.com/controltower/latest/userguide/lifecycle-events.html"  class="external-link" target="_blank" rel="noopener">AWS Control Tower Lifecycle Events</a>, which are intercepted as new OUs and accounts are added, and the <a href="https://docs.aws.amazon.com/cdk/v2/guide/cdk_pipeline.html"  class="external-link" target="_blank" rel="noopener">CDK Pipeline</a>, which is triggered by the events.</p>
<p>Permission sets and OU mappings are defined in a single, simple YAML file.</p>
<p>The following example permissions set is named <code>PowerAccess</code> and includes the managed policy <code>PowerUserAccess</code> and an in-line policy document defined in a JSON file. The permission set is mapped to the <code>Development</code> OU from the root of the organization (<code>/Root</code>). Because recursive is set to <code>true</code>, the permission set is mapped to all sub-accounts and sub-OUs under <code>Development</code>. This includes new accounts that are added later on.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#f92672">permission_set_name</span>: <span style="color:#ae81ff">PowerAccess</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">description</span>: <span style="color:#e6db74">&#34;Provides Power access permissions to Development AWS accounts&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">session_duration</span>: <span style="color:#ae81ff">PT04H</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">aws_managed_policies</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">arn:aws:iam::aws:policy/PowerUserAccess</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">inline_policy_document_file</span>: <span style="color:#ae81ff">policies/PowerUserAccess.json</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ou_assignments</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/Root/Development</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">recursive</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">group_assignments</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">PowerUserAccess</span>
</span></span></code></pre></div><p>This approach makes it easy to define new permission sets, add permissions and map the permission sets to groups of users from the identity provider.</p>
<h1 id="architecture">
  Architecture
  <a class="heading-link" href="#architecture">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>The following diagram provides an overview of the Ezpresso architecture.</p>
<p><img src="images/ezpresso_architecture.drawio.png" alt="Ezpresso overview"></p>
<h1 id="where">
  Where
  <a class="heading-link" href="#where">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>The Ezpresso CDK app can be found in the GitHub <a href="https://github.com/virtuability/ezpresso"  class="external-link" target="_blank" rel="noopener">virtuability/ezpresso</a> repository. The README includes information on prerequisites and how to deploy the app.</p>
<h1 id="examples">
  Examples
  <a class="heading-link" href="#examples">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Example configuration exists in the file <a href="https://github.com/virtuability/ezpresso/blob/main/config/sso-permission-sets.yaml"  class="external-link" target="_blank" rel="noopener">config/sso-permission-sets.yaml</a>.</p>
<h1 id="collaboration">
  Collaboration
  <a class="heading-link" href="#collaboration">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>We have provided a CDK app for easy and automatic deployment of AWS Identity Center permission sets. But we realise that many more features can be added.</p>
<p>We, therefore, encourage people with suggestions to contribute to the project.</p>
<p>Please feel free to create a change or raise an issue and we will review them as quickly as we can.</p>

  </article>
</section>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
     Morten Jensen 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  <script async defer data-domain="jensenmo.github.io" src="https://plausible.io/js/script.js"></script>


  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
